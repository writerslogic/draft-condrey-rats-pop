<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
  <!ENTITY RFC2119 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
  <!ENTITY RFC8174 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml">
  <!ENTITY RFC4086 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4086.xml">
  <!ENTITY RFC5869 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5869.xml">
  <!ENTITY RFC8949 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8949.xml">
  <!ENTITY RFC9052 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.9052.xml">
  <!ENTITY RFC9334 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.9334.xml">
  <!ENTITY I-D.condrey-rats-pop SYSTEM "https://bib.ietf.org/public/rfc/bibxml3/reference.I-D.condrey-rats-pop.xml">
]>
<rfc ipr="trust200902" docName="draft-condrey-rats-witnessd-enrollment-01" category="std" consensus="true" submissionType="independent">

  <front>
    <title abbrev="PoP Enrollment">Trust Anchor Bootstrap Protocol for Proof of Process</title>

    <author fullname="David Condrey" initials="D." surname="Condrey">
      <organization>Writerslogic Inc</organization>
      <address>
        <email>david@writerslogic.com</email>
      </address>
    </author>

    <date month="February" day="6" year="2026"/>

    <area>Security</area>
    <workgroup>Remote ATtestation procedureS</workgroup>

    <keyword>attestation</keyword>
    <keyword>enrollment</keyword>
    <keyword>trust anchor</keyword>
    <keyword>DID</keyword>

    <abstract>
      <t>This document specifies the trust anchor bootstrap protocol
      for the Proof of Process architecture.  It defines procedures
      for initial device enrollment, cryptographic key generation and
      certification, trust anchor establishment with Verifier
      services, and the issuance of device attestation certificates
      that bind an Attester identity to its hardware platform.  The
      protocol ensures that evidence produced by enrolled devices can
      be traced to a specific hardware root of trust.</t>
    </abstract>
  </front>

  <middle>
    <section title="Introduction">
      <t>Before an Attester device can produce verifiable authorship
      evidence, it must establish a trust relationship with the
      broader Proof of Process ecosystem.  This trust relationship
      begins with device enrollment, during which the Attester
      generates its cryptographic identity, proves possession of a
      hardware root of trust, and receives a device attestation
      certificate from an Endorser.</t>

      <t>This document defines the Trust Anchor Bootstrap Protocol
      (TABP), which governs the enrollment lifecycle from initial
      key generation through certificate issuance.  The protocol is
      designed to work with diverse hardware platforms, including
      devices with Trusted Platform Modules (TPMs), Secure Enclaves,
      and software-only environments with reduced trust assurances.</t>

      <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
      "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT
      RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be
      interpreted as described in BCP 14 <xref target="RFC2119"/>
      <xref target="RFC8174"/> when, and only when, they appear in
      all capitals, as shown here.</t>
    </section>

    <section title="Key Generation">
      <t>During enrollment, the Attester MUST generate an asymmetric
      key pair for signing evidence records.  The private key MUST be
      generated using a cryptographically secure random number
      generator as described in <xref target="RFC4086"/>.  On devices
      with hardware key storage, the private key SHOULD be generated
      within and never exported from the secure element.</t>

      <t>The Attester derives a device identity key and a session
      signing key from a root secret using HKDF
      (<xref target="RFC5869"/>).  The device identity key is
      long-lived and used for enrollment and re-enrollment operations.
      The session signing key is rotated periodically and used for
      day-to-day evidence signing.  Both keys use the COSE key
      structures defined in <xref target="RFC9052"/>.</t>

      <t>The key generation procedure produces the following
      artifacts: a device identity key pair, an initial session
      signing key pair, a platform attestation blob from the
      hardware security module (if available), and a key derivation
      transcript that records the HKDF parameters used.  All
      artifacts are serialized in CBOR (<xref target="RFC8949"/>)
      for transport.</t>
    </section>

    <section title="Enrollment Protocol">
      <t>The enrollment protocol consists of three message exchanges
      between the Attester and the Endorser.  In the first exchange,
      the Attester sends an enrollment request containing its device
      identity public key, the platform attestation blob, and a
      freshness nonce.  The Endorser validates the platform
      attestation against known-good reference values from the
      Reference Value Provider as defined in the RATS architecture
      (<xref target="RFC9334"/>).</t>

      <t>In the second exchange, the Endorser sends a challenge to
      the Attester that requires demonstrating control of the
      private key and access to the hardware security module.  The
      Attester responds with a signed challenge response that
      includes a measurement of the Attester software environment.
      This step ensures that the enrolling device is running
      authorized software.</t>

      <t>In the third exchange, upon successful validation, the
      Endorser issues a device attestation certificate binding the
      Attester's public key to its hardware identity.  The
      certificate is encoded as a COSE_Sign1 structure and includes
      the platform type, the trust tier (hardware, firmware, or
      software), and a validity period.  The Attester stores the
      certificate alongside its key material for use in subsequent
      evidence signing operations.</t>
    </section>

    <section title="Trust Anchor Distribution">
      <t>Verifiers need access to Endorser public keys to validate
      device attestation certificates.  This document defines a
      trust anchor distribution mechanism where Endorser certificates
      are published to a well-known HTTPS endpoint.  Verifiers
      SHOULD cache trust anchor certificates and refresh them at
      intervals no longer than 24 hours.</t>
    </section>

    <section title="Security Considerations">
      <t>The security of the enrollment protocol depends on the
      integrity of the hardware platform attestation.  Devices that
      cannot provide hardware-backed platform attestation receive a
      lower trust tier, and Verifiers MAY apply stricter appraisal
      policies to evidence from software-only Attesters.  The
      enrollment protocol MUST be conducted over a confidential
      and authenticated channel to prevent key substitution
      attacks.</t>
    </section>

    <section title="IANA Considerations">
      <t>This document has no IANA actions.</t>
    </section>
  </middle>

  <back>
    <references title="Normative References">
      &RFC2119;
      &RFC8174;
      &RFC4086;
      &RFC5869;
      &RFC8949;
      &RFC9052;
    </references>

    <references title="Informative References">
      &RFC9334;
      &I-D.condrey-rats-pop;
    </references>
  </back>
</rfc>
