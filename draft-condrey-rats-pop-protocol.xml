<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>

<!DOCTYPE rfc [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">

  <!ENTITY RFC2119 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
  <!ENTITY RFC8174 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml">
  <!ENTITY RFC2104 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.2104.xml">
  <!ENTITY RFC3339 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.3339.xml">
  <!ENTITY RFC6234 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.6234.xml">
  <!ENTITY RFC8610 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8610.xml">
  <!ENTITY RFC8949 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8949.xml">
  <!ENTITY RFC9052 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.9052.xml">
  <!ENTITY RFC9334 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.9334.xml">
  <!ENTITY RFC9711 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.9711.xml">
  <!ENTITY RFC5869 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.5869.xml">
  <!ENTITY RFC6973 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.6973.xml">
  <!ENTITY RFC9562 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.9562.xml">
  <!ENTITY RFC3161 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.3161.xml">
]>

<rfc ipr="trust200902" docName="draft-condrey-rats-pop-protocol-00" category="exp" consensus="false" submissionType="IETF">
  <front>
    <title abbrev="RATS PoP Protocol">Proof of Process Protocol: State Machine, Semantic Events, and Cryptographic Parameters</title>

    <author initials="D." surname="Condrey" fullname="David Condrey">
      <organization>Writerslogic Inc</organization>
      <address>
        <email>david@writerslogic.com</email>
      </address>
    </author>

    <date year="2026" month="February" day="14"/>

    <area>Security</area>
    <workgroup>Remote ATtestation procedureS</workgroup>
    <keyword>attestation</keyword>
    <keyword>evidence</keyword>
    <keyword>authorship</keyword>
    <keyword>RATS</keyword>
    <keyword>protocol</keyword>
    <keyword>state machine</keyword>

    <abstract>
      <t>This document defines the Proof of Process (PoP) protocol for
      digital authorship attestation. It specifies the evidence collection
      state machine, semantic event definitions, cryptographic parameters,
      and Verifiable Delay Function (VDF) mechanisms that bind behavioral
      evidence to elapsed wall-clock time. The protocol builds on the IETF
      RATS architecture (RFC 9334) and defines the Attester, Verifier, and
      Relying Party roles for process-based attestation.</t>
    </abstract>
  </front>

  <middle>
    <section anchor="sec-introduction" title="Introduction">
      <t>The proliferation of AI-generated content has created an urgent
      need for mechanisms that can attest to the human authorship process
      of digital works. This document specifies the Proof of Process (PoP)
      protocol, which captures tamper-evident behavioral evidence during
      content creation and binds it to cryptographic time proofs.</t>

      <t>This document is the protocol specification. A companion document,
      draft-condrey-rats-pop-appraisal, defines the verification procedures,
      forensic assessment mechanisms, and forgery cost analysis.</t>
    </section>

    <section anchor="sec-conventions" title="Conventions and Definitions">
      <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
      "OPTIONAL" in this document are to be interpreted as described in
      BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and
      only when, they appear in all capitals, as shown here.</t>
    </section>

    <section anchor="sec-state-machine" title="Evidence Collection State Machine">
      <t>The Attester operates a state machine with the following states:</t>
      <t>
        <list style="hanging">
          <t hangText="IDLE:">No active evidence collection session.</t>
          <t hangText="COLLECTING:">Actively capturing behavioral events
          within an evidence window.</t>
          <t hangText="SEALING:">Computing the jitter seal and VDF proof
          for the current window.</t>
          <t hangText="CHAINING:">Linking the sealed packet to the
          evidence chain.</t>
          <t hangText="SUSPENDED:">Session paused (e.g., user inactive).
          A continuation token is generated.</t>
        </list>
      </t>

      <t>Transitions between states are triggered by semantic events
      (keystroke, revision, pause, window-close) as defined in
      <xref target="sec-semantic-events"/>.</t>
    </section>

    <section anchor="sec-semantic-events" title="Semantic Event Definitions">
      <t>The following semantic events drive the state machine:</t>
      <t>
        <list style="hanging">
          <t hangText="KEYSTROKE:">A character insertion or deletion.
          Captured with microsecond-resolution timing.</t>
          <t hangText="REVISION:">A multi-character edit operation
          (cut, paste, undo, find-replace).</t>
          <t hangText="PAUSE:">An inactivity period exceeding the
          configured pause threshold (default: 5 seconds).</t>
          <t hangText="WINDOW_CLOSE:">The evidence collection window
          has elapsed (default: 30 seconds), triggering transition
          to SEALING state.</t>
          <t hangText="SESSION_END:">The authorship session is
          terminated, triggering chain finalization.</t>
        </list>
      </t>
    </section>

    <section anchor="sec-vdf" title="Verifiable Delay Function Mechanisms">
      <t>The framework employs Verifiable Delay Functions (VDFs) to bind
      evidence to elapsed wall-clock time. The VDF construction uses
      repeated squaring in an RSA group:</t>
      <t>y = x^(2^t_vdf) mod N</t>
      <t>where x is derived from the evidence packet hash, t_vdf controls
      the time parameter, and N is an RSA modulus from a trusted setup.
      Verification uses Wesolowski's protocol in O(log t_vdf) time.</t>
    </section>

    <section anchor="sec-jitter-seal" title="Jitter Seal">
      <t>The jitter seal binds evidence to physical timing characteristics:</t>
      <t>seal = HMAC-SHA-256(device_key, timing_vector || t_vdf || nonce)</t>
    </section>

    <section anchor="sec-continuation" title="Continuation Tokens">
      <t>Continuation tokens link evidence across sessions using HKDF-derived
      session keys with per-session salt, enabling Verifiers to assess the
      complete authorship timeline.</t>
    </section>

    <section anchor="sec-privacy" title="Privacy Considerations">
      <t>Evidence packets MUST be constructed using the principle of data
      minimization per <xref target="RFC6973"/>. Keystroke timing MUST be
      aggregated into statistical summaries. The Attester MUST NOT record
      plaintext content.</t>
    </section>

    <section anchor="sec-security" title="Security Considerations">
      <t>See the companion appraisal document for detailed security analysis.
      This section summarizes key protocol-level security properties:</t>
      <t>
        <list style="symbols">
          <t>Attester compromise: mitigated by hardware-bound keys.</t>
          <t>Replay attacks: prevented by VDF time-binding and session nonces.</t>
          <t>Relay attacks: prevented by content-hash binding.</t>
        </list>
      </t>
    </section>

    <section anchor="sec-iana" title="IANA Considerations">
      <t>This document requests registration of the media type
      application/pop-evidence+cbor and COSE header parameter
      pop-chain-ref.</t>
    </section>
  </middle>

  <back>
    <references title="References" anchor="sec-combined-references">
      <references title="Normative References" anchor="sec-normative-references">
        &RFC2119;
        &RFC8174;
        &RFC2104;
        &RFC3339;
        &RFC6234;
        &RFC8610;
        &RFC8949;
        &RFC9052;
        &RFC9334;
        &RFC9711;
      </references>

      <references title="Informative References" anchor="sec-informative-references">
        &RFC3161;
        &RFC5869;
        &RFC6973;
        &RFC9562;
      </references>
    </references>
  </back>
</rfc>
