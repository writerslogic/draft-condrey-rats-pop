<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>

<!DOCTYPE rfc [
  <!ENTITY nbsp    "&#160;">
  <!ENTITY zwsp   "&#8203;">
  <!ENTITY nbhy   "&#8209;">
  <!ENTITY wj     "&#8288;">

  <!ENTITY RFC2119 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
  <!ENTITY RFC8174 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml">
  <!ENTITY RFC2104 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.2104.xml">
  <!ENTITY RFC3339 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.3339.xml">
  <!ENTITY RFC6234 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.6234.xml">
  <!ENTITY RFC8610 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8610.xml">
  <!ENTITY RFC8949 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.8949.xml">
  <!ENTITY RFC9052 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.9052.xml">
  <!ENTITY RFC9334 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.9334.xml">
  <!ENTITY RFC9711 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.9711.xml">
  <!ENTITY RFC5869 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.5869.xml">
  <!ENTITY RFC6973 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.6973.xml">
  <!ENTITY RFC9562 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.9562.xml">
  <!ENTITY RFC3161 SYSTEM "https://bib.ietf.org/public/rfc/bibxml/reference.RFC.3161.xml">
]>

<rfc ipr="trust200902" docName="draft-condrey-rats-pop-protocol-03" category="exp" consensus="false" submissionType="IETF">
  <front>
    <title abbrev="RATS PoP Protocol">Proof of Process Protocol: State Machine, Semantic Events, and Cryptographic Parameters</title>

    <author initials="D." surname="Condrey" fullname="David Condrey">
      <organization>Writerslogic Inc</organization>
      <address>
        <email>david@writerslogic.com</email>
      </address>
    </author>

    <date year="2026" month="February" day="15"/>

    <area>Security</area>
    <workgroup>Remote ATtestation procedureS</workgroup>
    <keyword>attestation</keyword>
    <keyword>evidence</keyword>
    <keyword>authorship</keyword>
    <keyword>RATS</keyword>
    <keyword>protocol</keyword>

    <abstract>
      <t>This document defines the Proof of Process (PoP) protocol for
      digital authorship attestation. It specifies the evidence collection
      state machine, semantic event definitions, cryptographic parameters,
      and Verifiable Delay Function (VDF) mechanisms that bind behavioral
      evidence to elapsed wall-clock time. The protocol builds on the IETF
      RATS architecture (RFC 9334) and defines the Attester, Verifier, and
      Relying Party roles for process-based attestation.</t>
    </abstract>
  </front>

  <middle>
    <section anchor="sec-introduction" title="Introduction">
      <t>The proliferation of AI-generated content has created an urgent
      need for mechanisms that can attest to the human authorship process
      of digital works. This document specifies the Proof of Process (PoP)
      protocol, which captures tamper-evident behavioral evidence during
      content creation and binds it to cryptographic time proofs.</t>

      <t>This document is the protocol specification. A companion document,
      draft-condrey-rats-pop-appraisal, defines the verification procedures,
      forensic assessment mechanisms, and forgery cost analysis.</t>
    </section>

    <section anchor="sec-conventions" title="Conventions and Definitions">
      <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
      "OPTIONAL" in this document are to be interpreted as described in
      BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and
      only when, they appear in all capitals, as shown here.</t>
    </section>

    <section anchor="sec-system-model" title="System Model">
      <t>The Proof of Process protocol maps onto the RATS architecture
      defined in <xref target="RFC9334"/>. The following entity roles
      are defined:</t>

      <section anchor="sec-system-attester" title="Attester">
        <t>The Attester is the software component running on the author's
        device that collects behavioral evidence during content creation.
        It operates the evidence collection state machine, computes
        cryptographic seals, and produces evidence packets. The Attester
        corresponds to the RATS Attester role.</t>
      </section>

      <section anchor="sec-system-verifier" title="Verifier">
        <t>The Verifier receives evidence chains and produces Attestation
        Results. It implements the appraisal algorithms defined in the
        companion document. The Verifier MUST be operated independently
        of the Attester to prevent self-attestation.</t>
      </section>

      <section anchor="sec-system-rp" title="Relying Party">
        <t>The Relying Party consumes Attestation Results to make trust
        decisions about content provenance. Examples include publishers,
        academic institutions, and content platforms.</t>
      </section>

      <section anchor="sec-system-endorser" title="Endorser">
        <t>An Endorser provides supplementary attestations about the
        Attester's environment, such as hardware attestation certificates
        from platform vendors (e.g., TPM manufacturer certificates per
        <xref target="RFC9711"/>).</t>
      </section>

      <section anchor="sec-system-compat" title="RATS Compatibility">
        <t>The protocol supports both the passport model (Attester sends
        evidence to Verifier, which produces result for Relying Party)
        and the background-check model (Relying Party forwards evidence
        to Verifier) as defined in <xref target="RFC9334"/>.</t>
      </section>
    </section>

    <section anchor="sec-threat-model" title="Threat Model">
      <t>The following attack taxonomy identifies the threats that the
      Proof of Process protocol is designed to resist:</t>

      <section anchor="sec-threat-retype" title="Retype Attack">
        <t>An adversary manually retypes AI-generated content to produce
        fresh behavioral evidence. Defense: the protocol captures
        fine-grained revision patterns (editing, restructuring, pausing
        to think) that differ significantly from sequential retyping.
        The forensic assessment in the companion document detects the
        characteristic monotonic typing pattern of retyping.</t>
      </section>

      <section anchor="sec-threat-replay" title="Replay Attack">
        <t>An adversary captures evidence from a legitimate authorship
        session and attempts to reuse it for different content. Defense:
        each evidence packet includes a content-hash binding to the
        specific document state, and session nonces prevent cross-session
        replay.</t>
      </section>

      <section anchor="sec-threat-relay" title="Relay Attack">
        <t>An adversary relays evidence from one authorship session to
        claim credit for a different document. Defense: the content-hash
        chain binds evidence to specific content transitions, making
        relay detectable.</t>
      </section>

      <section anchor="sec-threat-swf" title="SWF Acceleration">
        <t>An adversary uses specialized hardware (FPGAs, ASICs) to
        accelerate VDF computation, enabling faster-than-real-time
        evidence generation. Defense: the difficulty parameter is
        calibrated per-device, and hardware attestation at T3/T4 tiers
        binds computation to the enrolled device.</t>
      </section>

      <section anchor="sec-threat-ae" title="Attestation Environment Spoofing">
        <t>An adversary spoofs the hardware attestation environment to
        bypass device identity checks. Defense: hardware attestation
        certificates are validated against manufacturer root certificates
        per <xref target="RFC9711"/>.</t>
      </section>

      <section anchor="sec-threat-diversion" title="Evidence Diversion">
        <t>An adversary redirects a legitimate evidence chain to claim
        authorship of different content by modifying the final content
        binding. Defense: the content-hash is included in every evidence
        packet (not just the final one), creating an incremental binding
        that cannot be diverted post-hoc.</t>
      </section>
    </section>

    <section anchor="sec-security-goals" title="Security Goals">
      <t>The protocol aims to achieve the following security properties:</t>
      <t>
        <list style="hanging">
          <t hangText="Temporal Authenticity:">Evidence is bound to
          wall-clock time through Sequential Work Functions, preventing
          after-the-fact fabrication.</t>
          <t hangText="Behavioral Authenticity:">Evidence captures
          genuine human behavioral characteristics that are
          computationally expensive to synthesize.</t>
          <t hangText="Content Binding:">Evidence is cryptographically
          bound to specific document content at each observation window.</t>
          <t hangText="Non-Repudiation:">The Attester cannot deny having
          produced a signed evidence chain, as the chain is bound to the
          device identity key.</t>
        </list>
      </t>
    </section>

    <section anchor="sec-state-machine" title="Evidence Collection State Machine">
      <t>The Attester operates a state machine with the following states:</t>
      <t>
        <list style="hanging">
          <t hangText="IDLE:">No active evidence collection session.</t>
          <t hangText="COLLECTING:">Actively capturing behavioral events
          within an evidence window.</t>
          <t hangText="SEALING:">Computing the jitter seal and VDF proof
          for the current window.</t>
          <t hangText="CHAINING:">Linking the sealed packet to the
          evidence chain.</t>
          <t hangText="SUSPENDED:">Session paused. A continuation token
          is generated.</t>
        </list>
      </t>
    </section>

    <section anchor="sec-semantic-events" title="Semantic Event Definitions">
      <t>The following semantic events drive the state machine:</t>
      <t>
        <list style="hanging">
          <t hangText="KEYSTROKE:">A character insertion or deletion.
          Captured with microsecond-resolution timing.</t>
          <t hangText="REVISION:">A multi-character edit operation
          (cut, paste, undo, find-replace).</t>
          <t hangText="PAUSE:">An inactivity period exceeding the
          configured pause threshold (default: 5 seconds).</t>
          <t hangText="WINDOW_CLOSE:">The evidence collection window
          has elapsed (default: 30 seconds).</t>
          <t hangText="SESSION_END:">The authorship session is
          terminated.</t>
        </list>
      </t>
    </section>

    <section anchor="sec-evidence-tiers" title="Evidence Content Tiers">
      <t>Evidence packets are classified into three tiers of increasing
      richness and assurance:</t>
      <t>
        <list style="hanging">
          <t hangText="CORE:">Basic behavioral metrics including typing
          cadence (mean and variance of inter-keystroke intervals),
          Shannon entropy of timing distributions, and revision count.
          Sufficient for T1 assurance.</t>
          <t hangText="ENHANCED:">CORE metrics plus Sequential Work
          Function time-binding, content-hash chain linking evidence to
          document state, and continuation tokens for cross-session
          linkage. Required for T2 assurance.</t>
          <t hangText="MAXIMUM:">ENHANCED metrics plus hardware-anchored
          timing (HAT) from a trusted execution environment, continuous
          device attestation, and environmental sensor data. Required
          for T3/T4 assurance.</t>
        </list>
      </t>
    </section>

    <section anchor="sec-assurance-levels" title="Attestation Assurance Levels">
      <t>Four assurance levels map evidence strength to established
      frameworks:</t>
      <t>
        <list style="hanging">
          <t hangText="T1 Basic:">Software-only attestation with
          behavioral entropy above minimum threshold. Maps to NIST AAL1 (<xref target="NIST-SP-800-63"/>)
          and ISO/IEC 29115 LoA 1 (<xref target="ISO-29115"/>).</t>
          <t hangText="T2 Standard:">T1 plus SWF time-binding proof.
          Maps to NIST AAL2 and ISO LoA 2.</t>
          <t hangText="T3 Enhanced:">T2 plus hardware-anchored timing
          from TPM or Secure Enclave. Maps to NIST AAL3 and
          ISO LoA 3.</t>
          <t hangText="T4 Maximum:">T3 plus continuous device
          attestation and environmental sensing. Exceeds NIST AAL3,
          maps to ISO LoA 4.</t>
        </list>
      </t>
    </section>

    <section anchor="sec-profiles" title="Profile Architecture">
      <t>All implementations MUST support the following mandatory-to-implement
      features:</t>
      <t>
        <list style="symbols">
          <t>CBOR encoding per <xref target="RFC8949"/></t>
          <t>COSE_Sign1 with ES256 per <xref target="RFC9052"/></t>
          <t>SHA-256 for content and chain hashing</t>
          <t>HMAC-SHA-256 for jitter seals</t>
          <t>UUIDv7 session identifiers per <xref target="RFC9562"/></t>
          <t>Evidence window duration: 15-60 seconds (default 30)</t>
        </list>
      </t>
    </section>

    <section anchor="sec-swf" title="Sequential Work Function">
      <t>This document uses the term Sequential Work Function (SWF)
      rather than Verifiable Delay Function (VDF) because the construction
      does not satisfy the formal VDF definition requiring unique outputs.
      The SWF provides a weaker but sufficient guarantee: computing the
      output requires a minimum number of sequential steps, and the output
      can be efficiently verified.</t>

      <t>The SWF construction uses repeated squaring in an RSA group:</t>
      <t>y = x^(2^t_vdf) mod N</t>
      <t>where x is derived from the evidence packet hash, t_vdf controls
      the time parameter, and N is an RSA modulus. Verification uses
      Wesolowski's protocol in O(log t_vdf) time.</t>

      <t>The difficulty parameter t_vdf MUST be calibrated to the
      Attester's hardware during enrollment such that evaluation requires
      approximately the same wall-clock time as the evidence window.</t>
    </section>

    <section anchor="sec-merkle-audit" title="Merkle-Sampled Audit Proofs">
      <t>For long evidence chains, the Verifier MAY use Merkle-sampled
      audit proofs instead of verifying every SWF proof. The Attester
      constructs a Merkle tree over all SWF outputs and provides:</t>
      <t>
        <list style="numbers">
          <t>The Merkle root of all SWF outputs.</t>
          <t>A random sample of k SWF proofs (where k is determined by
          the desired statistical confidence).</t>
          <t>Merkle inclusion proofs for each sampled output.</t>
        </list>
      </t>
      <t>This achieves O(k log n) verification cost instead of O(n),
      with detection probability 1 - (1 - f/n)^k for a fraction f of
      invalid proofs.</t>
    </section>

    <section anchor="sec-hat" title="Hardware-Anchored Time">
      <t>For T3 and T4 assurance levels, the Attester MUST supplement
      SWF proofs with hardware-anchored timestamps from a trusted
      execution environment:</t>
      <t>
        <list style="symbols">
          <t>TPM Clock: A monotonic counter from the TPM that cannot be
          reset or rolled back by software.</t>
          <t>Secure Enclave Counter: A platform-specific monotonic
          counter from the Secure Enclave or TrustZone.</t>
        </list>
      </t>
      <t>The Verifier validates that the HAT timestamps are consistent
      with the SWF timing proofs within a 5% tolerance.</t>
    </section>

    <section anchor="sec-jitter-seal" title="Jitter Seal">
      <t>seal = HMAC-SHA-256(device_key, timing_vector || t_vdf || nonce)</t>
    </section>

    <section anchor="sec-continuation" title="Continuation Tokens">
      <t>Continuation tokens link evidence across sessions using
      HKDF-derived session keys (<xref target="RFC5869"/>) with
      per-session salt. Tokens MUST expire after 24 hours and MUST
      be rotated at the start of each new session.</t>
    </section>

    <section anchor="sec-privacy" title="Privacy Considerations">
      <t>Evidence packets MUST be constructed using the principle of data
      minimization per <xref target="RFC6973"/>. Specifically:</t>
      <t>
        <list style="symbols">
          <t>The Attester MUST NOT record plaintext document content.
          Only cryptographic hashes of content state are retained.</t>
          <t>Keystroke timing MUST be aggregated into statistical
          summaries (mean, variance, entropy) rather than stored as
          raw event sequences.</t>
          <t>Behavioral features MUST be quantized to prevent
          de-anonymization through stylometric analysis. Quantization
          bins MUST be at least 10ms wide for timing data.</t>
          <t>Per-session key rotation MUST be used to prevent the
          Verifier from correlating evidence across different documents
          by the same author (unlinkability).</t>
        </list>
      </t>
    </section>

    <section anchor="sec-security" title="Security Considerations">
      <t>See the companion appraisal document for detailed security analysis.
      Protocol-level security properties include resistance to replay,
      relay, and retype attacks as described in
      <xref target="sec-threat-model"/>.</t>
    </section>

    <section anchor="sec-iana" title="IANA Considerations">
      <t>This document requests registration of the media type
      application/pop-evidence+cbor and COSE header parameter
      pop-chain-ref.</t>
    </section>
  </middle>

  <back>
    <references title="References" anchor="sec-combined-references">
      <references title="Normative References" anchor="sec-normative-references">
        &RFC2119;
        &RFC8174;
        &RFC2104;
        &RFC3339;
        &RFC6234;
        &RFC8610;
        &RFC8949;
        &RFC9052;
        &RFC9334;
        &RFC9711;
      </references>

      <references title="Informative References" anchor="sec-informative-references">
        &RFC3161;
        &RFC5869;
        &RFC6973;
        &RFC9562;

        <reference anchor="NIST-SP-800-63">
          <front>
            <title>Digital Identity Guidelines</title>
            <author>
              <organization>National Institute of Standards and Technology</organization>
            </author>
            <date year="2017" month="June"/>
          </front>
          <seriesInfo name="NIST Special Publication" value="800-63-3"/>
        </reference>

        <reference anchor="ISO-29115">
          <front>
            <title>Information technology - Security techniques - Entity authentication assurance framework</title>
            <author>
              <organization>International Organization for Standardization</organization>
            </author>
            <date year="2013"/>
          </front>
          <seriesInfo name="ISO/IEC" value="29115:2013"/>
        </reference>
      </references>
    </references>
  </back>
</rfc>
